[["index.html", "Phylogenomics with SISRS Chapter 1 Getting Started", " Phylogenomics with SISRS Rachel Schwartz 2021-09-22 Chapter 1 Getting Started This book will walk you through a complete phylogenomics project, from researching your study species to getting data to building phylogenies. "],["introduction.html", "Chapter 2 Introduction 2.1 Phylogenies", " Chapter 2 Introduction In this class we are going to conduct a research project using genomic data to figure out how a set of species are related (i.e. build phylogenies). Start by watching this introduction to animal evolution. 2.1 Phylogenies If you’re familiar with the basics of evolution you’re probably familiar with phylogenies: the tree-like structure that allows you to tell how closely related species are. For example, here is a simply phylogeny of some groups of vertebrates: To gain further understanding of phylogenies and phylogenetics check out A brief description of phylogenetics. Importance of phylogenetics Phylogenies Example phylogeny: a family tree Phylogenies as evolutionary history Phylogenies as a tool "],["research.html", "Chapter 3 Research 3.1 Selecting a group to study 3.2 Learning about your group 3.3 Freewrite assignment 3.4 Annotated Bibliography assignment 3.5 Reflection assignment", " Chapter 3 Research 3.1 Selecting a group to study Now that you have a sense of why phylogenies are so important you can start to think about a group whose evolutionary history you might like to investigate. Watch this video to understand the motivation behind phylogenetic research. You will see that our understanding of how species are related is constantly changing. That means that you can play a role you can play in determining how evolution happened. You can pick any group to study or ask your instructor for suggestions. Once you pick a group you’ll need to investigate it a bit more to determine whether you can narrow your research to address particularly interesting research questions, and then determine whether there are data to help you answer those questions. You might consider picking a group that is studied by URI faculty. If you still need ideas click here. 3.2 Learning about your group You will need to do some background research to learn about the group you propose to study, and to provide motivation of your work. Check out the URI Library’s Basics of College Level Research. 3.2.1 Finding research articles To get started find out something about your group. You can start with Google, although you should rapidly move on to searching the primary literature. Learn about scholarly and popular sources to understand why you need to go beyond popular or secondary literature. Also check out the URI Library’s discussion on why not just search Google. For general suggestions on finding literature on your topic see the URI Library’s guide to finding journal articles. The URI Library offers a variety of databases for research, but Google Scholar can be a good way to find literature on your topic. How to use Google Scholar: https://www.youtube.com/watch?v=B7bUS9TYvRU https://www.youtube.com/watch?v=6vSE-_iq7NE URI’s guide to Google Scholar If you are struggling to find papers that seem relevant to your research topic try the URI Library’s guide to developing an effective search strategy. When you find an article you want, you can access it as a member of the URI community. However, if you are off campus the journal may not recognize you. In Google Scholar click the menu bar in the upper left and choose settings. Search for the University of Rhode Island and select URI library. Google Scholar will now have Search @ URI Libraries on the right if there’s an article you want. If you still have problems you may need to search for you article via the library website. Go to https://web.uri.edu/library/. Under Find Resources paste the name of an article of interest and Search. Find the online resource that allows you to have access and sign in with your URI login. If URI has access to the article you should be able to read it. You may need to repeat your search on the URI website for other articles depending on your connection. 3.2.2 Reading research articles Once you locate a paper to read you need to read it. Check out these recommendations on how to read a paper efficiently and effectively: https://www.youtube.com/watch?v=Gv5ku0eoY6k https://www.youtube.com/watch?v=IeaD0ZaUJ3Y Continue to search for and read background material using the Citation Tracking Activity. At this point you may have picked a group to study, and hopefully you have a good reason for this group. Keep in mind that you may be fascinated by a particular group of species, but you still have to convince others to be equally fascinated. If you aren’t sure, try explaining your project to a friend or roommate. Also check out past projects for example research questions. 3.2.3 More background information At this point you should have a group of species and a (possibly vague) question. You won’t have everything pinned down precisely, but write down what you have. Now let’s research your group a bit more. First, find out more about your group, particularly the number of species and its age, by looking at Wikipedia and searching Google. If you picked a group that has a lot of species (e.g. birds, mammals), see if you can pick a smaller clade within your group of interest. You can also find out more about the species in your group by searching the Open Tree of Life and TimeTree. 3.3 Freewrite assignment At this point you should have a lot of ideas in your head. Now is the time to write them down. When scientists plan their research project they typically do a lot of writing. In this end this kind of writing turns into a formal research proposal, but the process of shaping that proposal usually starts with lots of notes about (1) what the researcher thinks the question is at the beginning, and (2) what is known in the field from reading a lot of papers. You are going to work through this process now to make a plan for your own research. First, write 1-2 pages of what you think your question is, why it’s interesting, and what is known in the field. If writing makes you think your question has already been answered, or needs more work before you can answer it, write all that down. You have two options here, first to truly freewrite your thoughts and see how they evolve and change, and second to go back and change your question if you discover it needs refinement. Either way, don’t get bogged down in details or grammar - try to get your ideas and background onto the paper. You should use this assignment to seek your plan and question yourself as to whether it will be successful. Think about this piece of work like an artist’s sketchbook that requires multiple tries to produce something that seems good. We will use this writing for discussion in class where you will have a chance to get comments so that you can have the best research plan moving forward. A successful freewrite will make you feel like you have a question and plan that will stand up to skeptical questioning by your peers. 3.4 Annotated Bibliography assignment Once you really know what you want to work on, you should make sure you understand the background to your research. That means reading the primary literature in more depth. An annotated bibliography can help you organize your understanding of this material. Develop an annotated bibliography of at least 5 sources. Note that you may need to skim 10-20 papers before settling on 5 to read in depth. See suggestions above for how to find and read papers. Your annotated bibliography should include the full citation (and probably a link for later use) followed by a 1-2 paragraph summary and/or bullets of the important points (particularly results) in the article as they relate to your research. The format is not critical. Note that an annotated bibliography is not an abstract. The annotated bibliography is for you to use later so take notes on what’s important for your research. Here are some examples and references: https://owl.purdue.edu/owl/general_writing/common_writing_assignments/annotated_bibliographies/annotated_bibliography_samples.html https://guides.library.cornell.edu/annotatedbibliography 3.5 Reflection assignment Write a short reflection on your annotatated bibliography. Why did you select the papers you chose to read more in depth? Why did you feel that the remaining papers were less relevant? Do you feel that your research question is strong and well motivated? Explain why. "],["getting-data.html", "Chapter 4 Getting Data", " Chapter 4 Getting Data Once you have settled on a group that you are interested in studying you need to find out if there are data to help you answer your research questions. Read more about the research process generally. We’ll be using genome sequence data to determine the species relationships in your group. Read the following to learn more about sequencing and molecular phylogenetics: 2nd generation sequencing Learn more about how molecular data is used in phylogenetics. Genomes ch. 16 To acquire molecular data to compare the species in your group you either need to do a lot of sequencing, or find sequencing someone else has done. Becuase sequencing takes time and money we’ll try using data that is already available and just hasn’t been analyzed to answer the questions you are interested in. Go to the European Nucleotide Archive Learn more about ENA here Select: Data type: Raw Reads Query: pick taxonomy (include subordinate) Add to query box: AND instrument_platform=&quot;ILLUMINA&quot; AND (library_strategy=&quot;RNA-Seq&quot; OR library_strategy=&quot;WGS&quot;) Fields: scientific_name, base_count, fastq_ftp Click Download report tsv Now you have a list of available data and relevant information to get it. It should look the same as what you saw in your browser. You can open this file in Excel or Google Sheets. It might look like you have a lot of data, but it’s actually hard to tell from this page. You might have a lot of data for one or a few species and not enough to analyze your whole group. To figure out which data you will need sort this list of samples by scientific_name. For each species (scientific_name column) you will need about 10 times the amount of bases as the size of the genome (i.e. you should have on average about 10 sequence fragments covering each base in the genome). To figure out how many bases you need use Google and Google Scholar to find the size of the genome of one of your species. Now that you know how many bases you need select the samples you want (for a total of 10x coverage) and save those in a separate sheet. The video on sequencing explains how the two ends of each genome fragment are sequenced. That means that most of your samples have two files to download. These are both listed in the fastq_ftp column. Highlight the fastq_ftp column, right-click, and select insert. Use Text-to-column in the Data menu to separate the column in two based on a semicolon. Once you are satisfied with the species you can work, use Google to find a species that is related, but not included in, your group. For example, if you are studying Primates you might select a rabbit as a related species. Go back to the ENA and find data for this species and add the appropriate lines to your download script. "],["computational-skills.html", "Chapter 5 Computational skills 5.1 Access from off campus (optional) 5.2 On a Mac 5.3 On a PC 5.4 Basic navigation", " Chapter 5 Computational skills The data you are working with is too large to analyze by hand. For example, the human genome is 3.2 billion bases. It would be hard to compare all that data to data from other species just using your eyes. Instead we’re going to need to learn some basic programming skills so we can tell the computer how to work with our data. First, you’ll have noticed that the computer we’re using doesn’t have the graphical interface you usually use (like a PC or Mac). That means you have to type in your commands - you can’t point and click. This actually has a hidden benefit because it’s easy to write down what you did in a line of text rather than having to try to explain where to click on each step. Let’s start by learning how to log in the our server and run commands without clicking. 5.1 Access from off campus (optional) Please go to https://security.uri.edu/duo/. There you will find instructions detailing how to enroll in DUO andset up Cisco AnyConnect. Make sure to follow the directions step by step and make a note of any issues or roadblocks so that you can report them to ITS Security Services. After installing and connecting to the VPN, please verify that you can connect to your specific network resources from home that you need to access. If you need to request VPN access prior to following these instructions see https://security.uri.edu/vpn/ 5.2 On a Mac 5.2.1 Getting access open your Terminal (you may need to search for it) follow the instructions under Generating an SSH Key at https://web.uri.edu/hpc-research-computing/using-andromeda/ 5.2.2 Log in to the server In your Terminal at the prompt type ssh -l username ssh3.hac.uri.edu , replacing username with the first part of your email address. You should see a prompt with ssh3 5.3 On a PC Download and install Putty. open Putty follow the instructions under Generating an SSH Key at https://web.uri.edu/hpc-research-computing/using-andromeda/ In the box marked Host Name type ssh3.hac.uri.edu, replacing username with the first part of your email address. Use your email username to log in You should see a prompt with ssh3 5.4 Basic navigation You are now logged in to Andromeda, which is a cluster of computers that can be used for research. First, you’ll need to learn to navigate around only by typing. Computing clusters typically require you to type all the commands. For example, to list all the files in your home folder (where you are when you log in) type ls. There probably isn’t anything in this folder right now. This is just like opening a folder in a Finder window on a Mac or a folder on a PC, except you had to type the command instead of simply double clicking. Second (and to help you get used to typing instead of clicking), let’s find out where we are in the folder structure. You should be in your home folder, which is inside another folder, and so on and so forth. Think of it as a highly organized filing cabinet, and you will need to move in between folders to access files. Type pwd to see the folder you are in. You’ll see your folder at the end, preceeded by a slash, preceeded by another folder, and so on. Your home folder is on a relatively small disk, so for all of our subsequent work we will use a large storage disk. This disk contains everyone’s data, organized by research lab. You change the directory using the cd command. To get to the main folder for the Schwartz lab you need to changed directories using the cd command. Unlike the prior commands you learned, but like most commands you’ll use, this command also takes an argument, which is another “word” that comes after this command. In this case you need the argument is the “path” to the folder. Type cd /data/schwartzlab. Let’s start by making a new folder to put your work in. Use the mkdir command to make a new directory. When you make a directory you need to name it, so instead of just mkdir you need mkdir newfolder or some other folder name. This is a shared lab folder so you should make a folder with your username. For example I might type mkdir rsschwartz. From now on I will refer to this as your main folder. Move into your folder (use cd) and make a new folder called data. Now that you have a new folder move into it. Type pwd again. Notice what folder you are in. To go back to the folder containing your current folder type cd .., which will take you one level up in the folder hierarchy. Type pwd again to see where you are now. Now that you have seen a few commands check out the Cheatsheet of commands at the end of the book for future reference. "],["getting-your-data.html", "Chapter 6 Getting your data 6.1 Download", " Chapter 6 Getting your data 6.1 Download Move into your data folder in your main folder with cd. If you aren’t continuing from the last chapter you may need to use the full path to your main folder. Our next step will be to download the data you want to work with onto Bluewaves. First we need to create a script to make this happen. A script is a detailed set of instructions for the computer to follow. Your script is going to be a series of instructions to download files and put them in particular folders so you can access them. We are going to use the program nano, which is built into the system, to write this script. Type nano download_data.sh. Again, we have a command followed by an argument (in this case the name of the file we are creating). Notice how the file ends in .sh. Just like you have files that end in .xls or .doc this tells the computer the file is a shell script. Commands in your shell script and just like commands on the command line. For each file you want to download type the following (separated by spaces) on a single line: wget The ftp link -P the scientific name (as one word without spaces) Repeat with the second ftp link for the sample if it has one. Repeat this process for each sample you want to download. Exit nano using ctrl-x and save your changes. There are many people doing work on the cluster so we need take advantage of the computing power of the cluster so that each student in the class can run their analysis on a separate computer. When you log in to the cluster you are on the “head node”. From here you can submit jobs to run analyses on the other nodes attached to the cluster. In order to communicate information about your job to the cluster you need to add the following lines to the beginning of your download script. #!/bin/bash #SBATCH --job-name=&quot;download&quot; #SBATCH --time=150:00:00 # walltime limit (HH:MM:SS) #SBATCH --nodes=1 # number of nodes #SBATCH --ntasks-per-node=36 # processor core(s) per node #SBATCH --mail-user=&quot;rsschwartz@uri.edu&quot; cd $SLURM_SUBMIT_DIR Replace the email address on the second-to-last line with yours. Quit nano and save. Submit your job as sbatch download_data.sh. You can monitor the progress of your download by listing the contents of your data folder and the contents of the folders inside it. "],["phylogenetic-markers.html", "Chapter 7 Phylogenetic markers 7.1 SISRS", " Chapter 7 Phylogenetic markers 7.1 SISRS Add what SISRS does In your main folder (cd back there if you need to) type git clone https://github.com/SchwartzLabURI/SISRS.git to download the software we will use to analyze your data. Since you only have to do this once don’t worry about details beyond the idea that you are downloading a program. Now we need to work with scripts (just like before) to run each step of the analysis. Move into the SISRS folder and then the scripts folder inside that. Slurm is the name of the software used to keep track of all the jobs you submit. Use nano to open slurm_submissions/1_submit.slurm. Change all the lines marked CHANGE to be relevant to your work. Exit nano and save the script. Submit your first job as sbatch slurm_submissions/1_submit.slurm. You will get an email when your job is done. Continue to edit scripts and submit jobs for steps 2, 3, 4, 5, 6, 6b, 6c, 6d, and 7, changing the information as with the first script. Wait for each script to report that it has completed before continuing to the next step and do not continue if your recieve any error messages. You will also need to change the ntasks-per-node line to 20 and use 20 processors any time that information is requested. Look for lines marked CHANGE. At the last step list several numbers for the missing flag in the range of approximately half of your species. "],["building-trees.html", "Chapter 8 Building Trees 8.1 Phylogenetic Data 8.2 Background on tree building 8.3 Building trees from your data (concatenation) 8.4 Building trees from your data (Multispecies coalescent) 8.5 Visualizing trees 8.6 What does my tree mean?", " Chapter 8 Building Trees 8.1 Phylogenetic Data You now have alignments of variable sites useful for building phylogenies. If you aren’t sure what that means refer back to some of the earlier materials. 8.2 Background on tree building Read more on phylogenies: Background https://zageno.com/l/guide-to-different-methods-of-phylogenetic-tree-construction https://www.youtube.com/playlist?list=PLZv47g5zgNKVcBDLTZzA6VT5bSHYr5KGj 8.3 Building trees from your data (concatenation) We will take a simple “concatenation” approach to analyzing your data. That means we will analyze all the sites together and expect them to come from one evolutionary history. There are more complex ways to consider the data, including different histories and different models that you can try later. Edit the runRaxml.sh slurm script for your data and submit it. This will generate plain text files of the best estimate of the phylogeny for your data using a Maximum Likelihood algorithm. 8.4 Building trees from your data (Multispecies coalescent) Another approach to use is a method modeling multispecies coalescent. SVDQuartets is one of such methods, specifically designed to work with site-based data. (It is assumed that the same phylip alignment that was used for the concatenation approach is used here; if your alignment is in the nexus format, omit the tonexus... line). Create an empty file which will become a slurm script that runs the program. Paste the following content in it: #!/bin/bash #SBATCH --job-name=&quot;svdq&quot; #SBATCH --time=150:00:00 # walltime limit (HH:MM:SS) #SBATCH --nodes=1 # number of nodes #SBATCH --ntasks-per-node=1 # processor core(s) per node #SBATCH -c 36 #SBATCH --mail-user=your_email cd $SLURM_SUBMIT_DIR module load PAUP/4.0a168-centos64 alignmentFile=&quot;svdquartets_tutorial/anomaly_zone.nex&quot; logFile=&quot;svdq.log&quot; treeFile=&quot;svdq.tre&quot; nBoot=1000 nCpus=36 date echo &quot; log file=${logFile}; tonexus format=RelPHYLIP fromfile=${alignmentFile} tofile=${alignmentFile}.svdq.nex interleaved=yes replace=yes; exe ${alignmentFile}.svdq.nex; svdq bootstrap nreps=${nBoot} nthreads=${nCpus}; saveTrees file=${treeFile}; quit; &quot; | paup date Adjust the email, the number of processors if needed (#SBATCH -c value should correspond to nCpus value), path and name of the input file (alignmentFile), and submit the script as sbatch job. 8.5 Visualizing trees Download Figtree to your personal computer. Download the file labeled RAxML_bipartitions (with the suffix for your analysis) (for the concatenation analysis) or svdq.tre (for the SVDQuartets multispecies coalescent analysis) to your personal computer. Open your tree file in Figtree Root tree using your outgroup. Look at bootstrap support on each node. 8.6 What does my tree mean? https://artic.network/how-to-read-a-tree.html "],["results.html", "Chapter 9 Results 9.1 What does your tree tell you?", " Chapter 9 Results 9.1 What does your tree tell you? You will need to compare your tree to prior results found in the literature. Go back to the first readings you did and continue to explore. Are your results novel (e.g. have you determined relationships among species that no one had investigated)? Do your results confirm or refute prior work? "],["sharing-your-results.html", "Chapter 10 Sharing your results 10.1 Start reading 10.2 Presentation 10.3 Writing a paper", " Chapter 10 Sharing your results 10.1 Start reading 10.1.1 Develop a bibliography You’ll need to keep track of everything you are reading. Try Zotero. 10.2 Presentation Slides on your study group. Don’t forget to convince your uninformed audience that this is the most fascinating group in the world with lots to help up understand about evolution. Slides on the information that isn’t known about this group - i.e. the question you will answer. Make sure we’re convinced that the question you answer will help us address all those cool questions you raised in 1. Your methods - briefly. Describe the approach, not the steps you take on the computer. Talk about methods, not software. Your tree. Highlight new information. Conclusions. What implications do your results have for evolutionary biology? Tips: https://research.usu.edu/undergradresearch/oral-presentations/ Great example: https://www.youtube.com/watch?v=fZ0NzM6g7jk 10.3 Writing a paper Your presentation forms a great outline for your final paper. Start by writing down everything you said for your presentation. Try noting different subsections. You might have to read more to completely elaborate on what you want to communicate. A professional scientific paper is approximately 4000-8000 words. However, your work, being focused on the phylogeny and perhaps not including any further discussion of evolution, is likely appropriate for a note in the jounal Molecular Phylogenetics and Evolution. Read their publishing guide. Example paper: https://www.scopus.com/record/display.uri?eid=2-s2.0-85030790294&amp;origin=inward&amp;txGid=b595bcdd0a2d7c7bb08bb94ba060397f https://writing-speech.dartmouth.edu/learning/materials/sources-and-citations-dartmouth 10.3.1 Intro 10.3.2 Methods https://www.youtube.com/watch?v=JzWUmkxlbEw 10.3.3 Results 10.3.4 Discussion "],["appendix.html", "Appendix Research Ideas", " Appendix Research Ideas Feeling a little lost as to how to pick a group to work on? There are so many species out there. It is hard to know what might be interesting. To get you started here are some examples of past research questions: Did disease-carrying ticks evolve so that closely related species carry the same parasite? Or do distantly related species have a single species of parasite that they carry? Did birds evolve to live on water once or more times? Do plants in South America that look similar share a common ancestor, or did that phenotype evolve more than once to adapt to the environment? Here are some groups that are studied at URI that you might find interesting: Hard coral (Scleractinia). Consider how Astrangia poculata might have evolved to live in the cold waters of New England (in doing background research look up the whole family). Adelgids. How did these species (hemipteran parasites on trees such as hemlock) parasitize species of trees? Sharks "],["citation-tracker-exercise.html", "Citation Tracker Exercise", " Citation Tracker Exercise As you read background literature for your research you should have encountered references to other literature in parentheses. The citations show where the paper’s author got their background information. In turn, these citations can provide further information for you to read in greater detail. Read the introduction an article you found in your Google Scholar search and look for information that appears highly relevant to your topic. Look for the citation that provided the author’s source for this information. Now look at the references at the end of the paper and find the full citation for the paper. Look up this paper using Google Scholar. Continue to look for citations in your original article and in this new article. As you read various articles, keep in mind that not all papers are highly relevant to your research question. You will likely not read all of these articles in depth. You can find additional relevant papers by looking for paper that cite an article you find particularly relevant. Search for your relevant paper in Google Scholar. Click on the Cited By link. Check out the papers Google Scholar has recorded as listing this paper in the citations. Note that articles are cited for many reasons, so many of the articles you see will not be relevant to your research. Using the processes above aim for a total of 15-20 papers you would consider reading in more depth. Adapted from Jenny Fielding, Reference Librarian Northern Essex Community College, Haverhill, Massachusetts Teaching Information Literacy Threshold Concepts : : Lesson Plans for Librarians, edited by Patricia Bravender, et al., Association of College &amp; Research Libraries, 2015. ProQuest Ebook Central, http://ebookcentral.proquest.com/lib/uri/detail.action?docID=5888806. "],["cheatsheet.html", "Cheatsheet", " Cheatsheet pwd: Print Working Directory: prints the path to the current folder cd [path to folder]: Change Directory mkdir [name of folder]: MaKe Directory nano [name of file]: Open a file with a text editor on the system sbatch [name of file]: Submit a job to run on the cluster "]]
