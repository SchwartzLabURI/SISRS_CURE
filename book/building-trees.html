<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Building Trees | Phylogenomics with SISRS</title>
  <meta name="description" content="Step-by-step guide for research using SISRS to get orthologs for phylogenomics." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Building Trees | Phylogenomics with SISRS" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Step-by-step guide for research using SISRS to get orthologs for phylogenomics." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Building Trees | Phylogenomics with SISRS" />
  
  <meta name="twitter:description" content="Step-by-step guide for research using SISRS to get orthologs for phylogenomics." />
  

<meta name="author" content="Rachel Schwartz" />


<meta name="date" content="2022-11-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="phylogenetic-markers.html"/>
<link rel="next" href="results.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Phylogenomics Research Course</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#phylogenies"><i class="fa fa-check"></i><b>2.1</b> Phylogenies</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#resources"><i class="fa fa-check"></i><b>2.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="research.html"><a href="research.html"><i class="fa fa-check"></i><b>3</b> Research</a><ul>
<li class="chapter" data-level="3.1" data-path="research.html"><a href="research.html#selecting-a-group-to-study"><i class="fa fa-check"></i><b>3.1</b> Selecting a group to study</a></li>
<li class="chapter" data-level="3.2" data-path="research.html"><a href="research.html#learning-about-your-group"><i class="fa fa-check"></i><b>3.2</b> Learning about your group</a><ul>
<li class="chapter" data-level="3.2.1" data-path="research.html"><a href="research.html#finding-research-articles"><i class="fa fa-check"></i><b>3.2.1</b> Finding research articles</a></li>
<li class="chapter" data-level="3.2.2" data-path="research.html"><a href="research.html#reading-research-articles"><i class="fa fa-check"></i><b>3.2.2</b> Reading research articles</a></li>
<li class="chapter" data-level="3.2.3" data-path="research.html"><a href="research.html#reading-for-your-research"><i class="fa fa-check"></i><b>3.2.3</b> Reading for your research</a></li>
<li class="chapter" data-level="3.2.4" data-path="research.html"><a href="research.html#more-background-information"><i class="fa fa-check"></i><b>3.2.4</b> More background information</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="research.html"><a href="research.html#freewrite-assignment"><i class="fa fa-check"></i><b>3.3</b> Freewrite assignment</a></li>
<li class="chapter" data-level="3.4" data-path="research.html"><a href="research.html#annotated-bibliography-assignment"><i class="fa fa-check"></i><b>3.4</b> Annotated Bibliography assignment</a></li>
<li class="chapter" data-level="3.5" data-path="research.html"><a href="research.html#reflection-assignment"><i class="fa fa-check"></i><b>3.5</b> Reflection assignment</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="getting-data.html"><a href="getting-data.html"><i class="fa fa-check"></i><b>4</b> Getting Data</a><ul>
<li class="chapter" data-level="4.1" data-path="getting-data.html"><a href="getting-data.html#example-data-and-trees"><i class="fa fa-check"></i><b>4.1</b> Example data and trees</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="computational-skills.html"><a href="computational-skills.html"><i class="fa fa-check"></i><b>5</b> Computational skills</a><ul>
<li class="chapter" data-level="5.1" data-path="computational-skills.html"><a href="computational-skills.html#access-from-off-campus-optional"><i class="fa fa-check"></i><b>5.1</b> Access from off campus (optional)</a></li>
<li class="chapter" data-level="5.2" data-path="computational-skills.html"><a href="computational-skills.html#on-a-mac"><i class="fa fa-check"></i><b>5.2</b> On a Mac</a><ul>
<li class="chapter" data-level="5.2.1" data-path="computational-skills.html"><a href="computational-skills.html#getting-access"><i class="fa fa-check"></i><b>5.2.1</b> Getting access</a></li>
<li class="chapter" data-level="5.2.2" data-path="computational-skills.html"><a href="computational-skills.html#log-in-to-the-server"><i class="fa fa-check"></i><b>5.2.2</b> Log in to the server</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="computational-skills.html"><a href="computational-skills.html#on-a-pc"><i class="fa fa-check"></i><b>5.3</b> On a PC</a></li>
<li class="chapter" data-level="5.4" data-path="computational-skills.html"><a href="computational-skills.html#basic-navigation"><i class="fa fa-check"></i><b>5.4</b> Basic navigation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="getting-your-data.html"><a href="getting-your-data.html"><i class="fa fa-check"></i><b>6</b> Getting your data</a><ul>
<li class="chapter" data-level="6.1" data-path="getting-your-data.html"><a href="getting-your-data.html#download"><i class="fa fa-check"></i><b>6.1</b> Download</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="phylogenetic-markers.html"><a href="phylogenetic-markers.html"><i class="fa fa-check"></i><b>7</b> Phylogenetic markers</a><ul>
<li class="chapter" data-level="7.1" data-path="phylogenetic-markers.html"><a href="phylogenetic-markers.html#sisrs"><i class="fa fa-check"></i><b>7.1</b> SISRS</a><ul>
<li class="chapter" data-level="7.1.1" data-path="phylogenetic-markers.html"><a href="phylogenetic-markers.html#what-sisrs-does"><i class="fa fa-check"></i><b>7.1.1</b> What SISRS does</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="building-trees.html"><a href="building-trees.html"><i class="fa fa-check"></i><b>8</b> Building Trees</a><ul>
<li class="chapter" data-level="8.1" data-path="building-trees.html"><a href="building-trees.html#background-on-tree-building"><i class="fa fa-check"></i><b>8.1</b> Background on tree building</a></li>
<li class="chapter" data-level="8.2" data-path="building-trees.html"><a href="building-trees.html#building-trees-from-your-data"><i class="fa fa-check"></i><b>8.2</b> Building trees from your data</a><ul>
<li class="chapter" data-level="8.2.1" data-path="building-trees.html"><a href="building-trees.html#likelihood"><i class="fa fa-check"></i><b>8.2.1</b> Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="building-trees.html"><a href="building-trees.html#visualizing-trees"><i class="fa fa-check"></i><b>8.3</b> Visualizing trees</a><ul>
<li class="chapter" data-level="8.3.1" data-path="building-trees.html"><a href="building-trees.html#download-your-results-to-your-computer"><i class="fa fa-check"></i><b>8.3.1</b> Download your results to your computer</a></li>
<li class="chapter" data-level="8.3.2" data-path="building-trees.html"><a href="building-trees.html#visualize-your-tree"><i class="fa fa-check"></i><b>8.3.2</b> Visualize your tree</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="building-trees.html"><a href="building-trees.html#what-does-my-tree-mean"><i class="fa fa-check"></i><b>8.4</b> What does my tree mean?</a></li>
<li class="chapter" data-level="8.5" data-path="building-trees.html"><a href="building-trees.html#other-tree-building-methods"><i class="fa fa-check"></i><b>8.5</b> Other tree building methods</a></li>
<li class="chapter" data-level="8.6" data-path="building-trees.html"><a href="building-trees.html#alternative-methods-of-support"><i class="fa fa-check"></i><b>8.6</b> Alternative methods of support</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>9</b> Results</a><ul>
<li class="chapter" data-level="9.1" data-path="results.html"><a href="results.html#what-does-your-tree-tell-you"><i class="fa fa-check"></i><b>9.1</b> What does your tree tell you?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sharing-your-results.html"><a href="sharing-your-results.html"><i class="fa fa-check"></i><b>10</b> Sharing your results</a><ul>
<li class="chapter" data-level="10.1" data-path="sharing-your-results.html"><a href="sharing-your-results.html#start-reading"><i class="fa fa-check"></i><b>10.1</b> Start reading</a><ul>
<li class="chapter" data-level="10.1.1" data-path="sharing-your-results.html"><a href="sharing-your-results.html#develop-a-bibliography"><i class="fa fa-check"></i><b>10.1.1</b> Develop a bibliography</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sharing-your-results.html"><a href="sharing-your-results.html#presentation"><i class="fa fa-check"></i><b>10.2</b> Presentation</a></li>
<li class="chapter" data-level="10.3" data-path="sharing-your-results.html"><a href="sharing-your-results.html#writing-a-paper"><i class="fa fa-check"></i><b>10.3</b> Writing a paper</a><ul>
<li class="chapter" data-level="10.3.1" data-path="sharing-your-results.html"><a href="sharing-your-results.html#methods"><i class="fa fa-check"></i><b>10.3.1</b> Methods</a></li>
<li class="chapter" data-level="10.3.2" data-path="sharing-your-results.html"><a href="sharing-your-results.html#results-1"><i class="fa fa-check"></i><b>10.3.2</b> Results</a></li>
<li class="chapter" data-level="10.3.3" data-path="sharing-your-results.html"><a href="sharing-your-results.html#intro"><i class="fa fa-check"></i><b>10.3.3</b> Intro</a></li>
<li class="chapter" data-level="10.3.4" data-path="sharing-your-results.html"><a href="sharing-your-results.html#discussion"><i class="fa fa-check"></i><b>10.3.4</b> Discussion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#research-ideas"><i class="fa fa-check"></i>Research Ideas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="citation-tracker-exercise.html"><a href="citation-tracker-exercise.html"><i class="fa fa-check"></i>Citation Tracker Exercise</a></li>
<li class="chapter" data-level="" data-path="cheatsheet.html"><a href="cheatsheet.html"><i class="fa fa-check"></i>Cheatsheet</a></li>
<li class="chapter" data-level="" data-path="citations-using-timetree.html"><a href="citations-using-timetree.html"><i class="fa fa-check"></i>Citations using TimeTree</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Phylogenomics with SISRS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="building-trees" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 8</span> Building Trees<a href="building-trees.html#building-trees" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="background-on-tree-building" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.1</span> Background on tree building<a href="building-trees.html#background-on-tree-building" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Watch the following videos on <a href="https://www.youtube.com/playlist?list=PLZv47g5zgNKVcBDLTZzA6VT5bSHYr5KGj">phylogenetic tree construction</a></p>
<ul>
<li>Video 1: review</li>
<li>Video 2: Tree building (UPGMA)</li>
<li>Video 6: Tree building (NJ)</li>
<li>Video 5: Tree building (parsimony)</li>
</ul>
<p>Don’t worry about the details - I just want you to get a sense of different methods of tree building rather than viewing this process as a “black box” where you just put your data into a computer program and get an answer. For a summary read
<a href="https://zageno.com/l/guide-to-different-methods-of-phylogenetic-tree-construction">A brief guide to the different methods of phylogenetic tree construction</a></p>
</div>
<div id="building-trees-from-your-data" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.2</span> Building trees from your data<a href="building-trees.html#building-trees-from-your-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="likelihood" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.2.1</span> Likelihood<a href="building-trees.html#likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll take two different approaches to build phylogenies from your data.
First, we’ll use software that calculates the likelihood that the data fit the phylogeny.
The software will try lots of different phylogenies and pick the case where the data are most likely.
When the software runs it will also try resampling the data to see how much support we have for each relationship we estimate.</p>
<ul>
<li>Use <code>nano</code> to open <code>runRAxML.sh</code> in the <code>slurm_submissions</code> folder.</li>
<li>Change the email address and add the necessary file information.</li>
<li>Submit the script as a slurm job.</li>
<li>Repeat for different datasets with different amounts of missing data.</li>
</ul>
</div>
</div>
<div id="visualizing-trees" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.3</span> Visualizing trees<a href="building-trees.html#visualizing-trees" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="download-your-results-to-your-computer" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.3.1</span> Download your results to your computer<a href="building-trees.html#download-your-results-to-your-computer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First figure out the complete path of your file using <code>pwd</code>.</p>
<div id="on-a-mac-1" class="section level4 hasAnchor">
<h4><span class="header-section-number">8.3.1.1</span> On a Mac<a href="building-trees.html#on-a-mac-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Make a new terminal window.</li>
<li><code>cd</code> to a local folder where you will work on this project (make a new folder if you need to)</li>
<li>type <code>scp username@ssh3.hac.uri.edu:path/filename .</code> (replacing username with your username, path with the path you just found and filename with the name of the output from raxml, which should start with RAxML_bipartitions)</li>
</ul>
</div>
<div id="on-a-pc-1" class="section level4 hasAnchor">
<h4><span class="header-section-number">8.3.1.2</span> On a PC<a href="building-trees.html#on-a-pc-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>See Transfering Data on <a href="https://its.uri.edu/research-computing/using-andromeda/#transfer">URI’s HPC Instructions</a>.</p>
</div>
</div>
<div id="visualize-your-tree" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.3.2</span> Visualize your tree<a href="building-trees.html#visualize-your-tree" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Download the visualization program <a href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a></li>
<li>Open your tree file</li>
<li>Select the branch leading to your outgroup and click Reroot</li>
<li>On the left menu select Node Labels - Display - label</li>
<li>Select Tip Labels and adjust the font size</li>
<li>When you have an aesthetically pleasing tree: File - Export PDF</li>
</ul>
</div>
</div>
<div id="what-does-my-tree-mean" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.4</span> What does my tree mean?<a href="building-trees.html#what-does-my-tree-mean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://artic.network/how-to-read-a-tree.html" class="uri">https://artic.network/how-to-read-a-tree.html</a></p>
</div>
<div id="other-tree-building-methods" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.5</span> Other tree building methods<a href="building-trees.html#other-tree-building-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another method for building phylogenies relies on selecting four species,
and determining the relationships of these species based on examining
different patterns of sites.
Four species are much easier to work with than more as there are only three possible ways these species can be related.
We can look at how often the grouping of sites matches each hypotheized why species are related.
You can read <a href="https://www.asc.ohio-state.edu/kubatko.2//SpeciesTreesLab1_2019_Annotated.pdf">the full explanation (with visuals)</a> but don’t worry if it’s complicated.
This method is implemented in SVDQuartets.</p>
<ul>
<li>Change the necessary files and information in <code>runSVDQ.sh</code> and submit it.</li>
<li>Download and examine your results.</li>
</ul>
</div>
<div id="alternative-methods-of-support" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.6</span> Alternative methods of support<a href="building-trees.html#alternative-methods-of-support" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The bootstrap approach automatically implemented by RAxML is one method of determining support.
However, bootstrap resampling can have limitations when using larger datasets.
An alternative approach is to examine the proportion of sites that support each alternative hypothesis given a tree,
similar to the SVDQ approach.
You can calculate SCF support by editing the <code>runSCF.sh</code> script and inputing your tree and your alignment.
If you estimated different trees using the above methods you may try more than one.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="phylogenetic-markers.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-trees.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
